<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="google-site-verification" content="Lbqbq-u0Mn24a7n3Er0wVtGF9AUxR-o_FZsCOl4YEOQ">














  
  
  <link href="/libs/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Lucida Grande:300,300italic,400,400italic,700,700italic|Zapfino:300,300italic,400,400italic,700,700italic|Monaco:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/libs/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/avatar1.jpg?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/avatar1.jpg?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/avatar1.jpg?v=5.1.4">


  <link rel="mask-icon" href="/images/avatar1.jpg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, Levi">





  <link rel="alternate" href="/atom.xml" title="Levi's blog" type="application/atom+xml">






<meta name="description" content="Shareness make me happy">
<meta property="og:type" content="website">
<meta property="og:title" content="Levi&#39;s blog">
<meta property="og:url" content="http://leviduan.com/page/2/index.html">
<meta property="og:site_name" content="Levi&#39;s blog">
<meta property="og:description" content="Shareness make me happy">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Levi&#39;s blog">
<meta name="twitter:description" content="Shareness make me happy">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: false,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://leviduan.com/page/2/">





  <title>Levi's blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta custom-logo">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Levi's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-time">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br>
            
            Time
          </a>
        </li>
      
        
        <li class="menu-item menu-item-ios">
          <a href="/categories/iOS/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-apple"></i> <br>
            
            iOS
          </a>
        </li>
      
        
        <li class="menu-item menu-item-react-n.">
          <a href="/categories/web/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-html5"></i> <br>
            
            React N.
          </a>
        </li>
      
        
        <li class="menu-item menu-item-algorithm">
          <a href="/categories/Algorithm/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br>
            
            Algorithm
          </a>
        </li>
      
        
        <li class="menu-item menu-item-idea">
          <a href="/categories/Idea/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-music"></i> <br>
            
            Idea
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://leviduan.com/2020/01/08/2020-01-08-4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Levi Duan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Levi's blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/08/2020-01-08-4/" itemprop="url">React native network library - Axios</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-08T22:47:04+08:00">
                2020-01-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web/" itemprop="url" rel="index">
                    <span itemprop="name">web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/01/08/2020-01-08-4/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/01/08/2020-01-08-4/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>How to use axios in React Native</p>
<h3 id="Axios-Interceptors"><a href="#Axios-Interceptors" class="headerlink" title="Axios Interceptors"></a>Axios Interceptors</h3><p>Axios interceptors allow us to run code or modify the request and response before the request and response is started.</p>
<p>In simple words, it allows you write or execute a piece of your code before the request gets sent.</p>
<h3 id="Write-into-a-file-to-package-Axios"><a href="#Write-into-a-file-to-package-Axios" class="headerlink" title="Write into a file to package Axios"></a>Write into a file to package Axios</h3><p>The simple example: </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">'axios'</span>;</span><br><span class="line"></span><br><span class="line">axios.defaults.retry = <span class="number">4</span>;</span><br><span class="line">axios.defaults.timeout = <span class="number">10000</span>;</span><br><span class="line">axios.defaults.headers.common[<span class="string">'x-dejafashion-ua'</span>] = <span class="string">' '</span></span><br><span class="line">axios.defaults.headers.common[<span class="string">'uid'</span>] = <span class="string">'0'</span></span><br><span class="line">axios.defaults.headers.common[<span class="string">'User-Agent'</span>] = <span class="string">'iphone ... CFNetwork/1098.7 Darwin/19.0.0'</span></span><br><span class="line"></span><br><span class="line">axios.defaults.headers.post[<span class="string">'Content-Type'</span>] = <span class="string">'application/json;charset=UTF-8'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> stylepedia_DT = <span class="string">'https://cloud-dt.co/'</span></span><br><span class="line"><span class="keyword">const</span> stylepedia_DP = <span class="string">'http://cloud-dp.co/'</span></span><br><span class="line"><span class="keyword">const</span> stylepedia_PR = <span class="string">'https://cloud.co/'</span></span><br><span class="line"></span><br><span class="line">axios.interceptors.response.use(<span class="literal">undefined</span>, <span class="function"><span class="keyword">function</span> <span class="title">axiosRetryInterceptor</span>(<span class="params">err</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> config = err.config;</span><br><span class="line">  <span class="comment">// If config does not exist or the retry option is not set, reject</span></span><br><span class="line">  <span class="keyword">if</span>(!config || !config.retry) <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(err);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Set the variable for keeping track of the retry count</span></span><br><span class="line">  config.__retryCount = config.__retryCount || <span class="number">0</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Check if we've maxed out the total number of retries</span></span><br><span class="line">  <span class="keyword">if</span>(config.__retryCount &gt;= config.retry) &#123;</span><br><span class="line">      <span class="comment">// Reject with the error</span></span><br><span class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(err);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Increase the retry count</span></span><br><span class="line">  config.__retryCount += <span class="number">1</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Create new promise to handle exponential backoff</span></span><br><span class="line">  <span class="keyword">var</span> backoff = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve</span>) </span>&#123;</span><br><span class="line">      setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">          resolve();</span><br><span class="line">      &#125;, config.retryDelay || <span class="number">1</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// Return the promise in which recalls axios to retry the request</span></span><br><span class="line">  <span class="keyword">return</span> backoff.then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> axios(config);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> axios.create(&#123;</span><br><span class="line">  baseURL: stylepedia_DP</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h3 id="You-can-use-this-file-to-send-a-Get-request"><a href="#You-can-use-this-file-to-send-a-Get-request" class="headerlink" title="You can use this file to send a Get request"></a>You can use this file to send a Get request</h3><p>if you want bring params, don’t forget to use <code>params</code> dictionary to add params</p>
<p>For example:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> API <span class="keyword">from</span> <span class="string">'../../Network/api'</span></span><br><span class="line"></span><br><span class="line">    searchInfluencersRequest() &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            influencerLoading: <span class="literal">true</span>,</span><br><span class="line">        &#125;);</span><br><span class="line">        API.get(<span class="string">'search/influencers'</span>, &#123;</span><br><span class="line">            params: &#123;</span><br><span class="line">                key: <span class="keyword">this</span>.state.searchText,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        </span><br><span class="line">            <span class="keyword">if</span> (res.data.ret === <span class="number">0</span> &amp;&amp; res.data.data !== <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">                    influencerArray: res.data.data.infuencer_item_list,</span><br><span class="line">                    influencerLoading: <span class="literal">false</span>,</span><br><span class="line">                &#125;)             </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">this</span>.setState(&#123; </span><br><span class="line">                    influencerArray: [],</span><br><span class="line">                    influencerLoading: <span class="literal">false</span>,</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">                influencerArray: [],</span><br><span class="line">                influencerLoading: <span class="literal">false</span>,</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h3 id="You-can-use-this-file-to-send-a-Post-request"><a href="#You-can-use-this-file-to-send-a-Post-request" class="headerlink" title="You can use this file to send a Post request"></a>You can use this file to send a Post request</h3><p>Send a Post request, the way is really similar to Get request</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">likeStatusRequest(likeStatus, street_id) &#123;</span><br><span class="line">    API.post(<span class="string">'favourite/favourite_status'</span>, &#123;</span><br><span class="line">      street_id: street_id,</span><br><span class="line">      like: likeStatus ? <span class="number">1</span> : <span class="number">0</span>,</span><br><span class="line">    &#125;)</span><br><span class="line">      .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        likeStatus</span><br><span class="line">          ? Toast.show(<span class="string">'Added to Favourites'</span>, &#123;</span><br><span class="line">              position: Toast.positions.CENTER,</span><br><span class="line">            &#125;)</span><br><span class="line">          : Toast.show(<span class="string">'Removed from Favourites'</span>, &#123;</span><br><span class="line">              position: Toast.positions.CENTER,</span><br><span class="line">            &#125;);</span><br><span class="line">      &#125;)</span><br><span class="line">      .catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(error);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h3 id="Sometimes-you-want-change-defaults-header"><a href="#Sometimes-you-want-change-defaults-header" class="headerlink" title="Sometimes you want change defaults header"></a>Sometimes you want change defaults header</h3><p>You can do it like this:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">API.defaults.headers.common[<span class="string">'uid'</span>] = global.uid;</span><br><span class="line">API.defaults.headers.common[<span class="string">'sig'</span>] = global.sig;</span><br></pre></td></tr></table></figure>
<h3 id="How-to-send-an-image-to-server？"><a href="#How-to-send-an-image-to-server？" class="headerlink" title="How to send an image to server？"></a>How to send an image to server？</h3><p>You need to new a FormData to add your image path 、image type and image rename.</p>
<p>don’t forget to change your ‘Content-Type’ headers.</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">uploadImageRequest() &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> formData = <span class="keyword">new</span> FormData();</span><br><span class="line">    <span class="keyword">let</span> file = &#123;<span class="attr">uri</span>: ../.../levi.png, <span class="attr">type</span>: <span class="string">'multipart/form-data'</span>, <span class="attr">name</span>: <span class="string">'image.png'</span>&#125;;   </span><br><span class="line">    formData.append(<span class="string">"file"</span>,file);  </span><br><span class="line">    <span class="keyword">let</span> config = &#123;</span><br><span class="line">        headers:&#123;<span class="string">'Content-Type'</span>:<span class="string">'multipart/form-data'</span>&#125;</span><br><span class="line">    &#125;; </span><br><span class="line">    API.post(<span class="string">'customer/upload'</span>,formData,config)</span><br><span class="line">      .then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            imageResponseUrl: res.data.url,</span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">      .catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(error);</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            isLookLoading: <span class="literal">false</span>,</span><br><span class="line">            noRequest: <span class="literal">false</span>,</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://leviduan.com/2020/01/08/2020-01-08-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Levi Duan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Levi's blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/08/2020-01-08-3/" itemprop="url">React native - Search bar</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-08T22:47:02+08:00">
                2020-01-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web/" itemprop="url" rel="index">
                    <span itemprop="name">web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/01/08/2020-01-08-3/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/01/08/2020-01-08-3/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>If you want to use SearchBar on React Native, the best choice is React Native Elements Library. you can use SearchBar module from React Native Elements.</p>
<p>The website: <a href="https://react-native-elements.github.io/react-native-elements/docs/input.html" target="_blank" rel="noopener">https://react-native-elements.github.io/react-native-elements/docs/input.html</a></p>
<h3 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h3><p>Step 1: Install react-native-elements</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">yarn add react-native-elements</span><br><span class="line"># or with npm</span><br><span class="line">npm install react-native-elements</span><br></pre></td></tr></table></figure>
<p>Step 2: Install react-native-vector-icons</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># yarn</span><br><span class="line">yarn add react-native-vector-icons</span><br><span class="line"># or with npm</span><br><span class="line">npm i --save react-native-vector-icons</span><br><span class="line"></span><br><span class="line"># link</span><br><span class="line">react-native link react-native-vector-icons</span><br></pre></td></tr></table></figure>
<p>Ps: if Xcode run error - react-native-vector-icons iOS run error - ‘Multiple commands produce’ error when building with new Xcode build system</p>
<p>The solution way : <strong>simply remove duplicate reference fonts in “Copy Bundle Resources” NOT in “[CP] Copy Pods Resources”</strong></p>
<p>You can correct to run iOS app.</p>
<h3 id="How-to-use-search-bar-on-RN"><a href="#How-to-use-search-bar-on-RN" class="headerlink" title="How to use search bar on RN"></a>How to use search bar on RN</h3><p>You can write the SearchBar Label to write a UI code like this: </p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; SearchBar &#125; <span class="keyword">from</span> <span class="string">'react-native-elements'</span>;</span><br><span class="line"></span><br><span class="line">&lt;SearchBar</span><br><span class="line">    inputContainerStyle=&#123;&#123;<span class="attr">backgroundColor</span>: <span class="string">'#EFEFEF'</span>&#125;&#125;</span><br><span class="line">    inputStyle=&#123;&#123;<span class="attr">backgroundColor</span>: <span class="string">'#EFEFEF'</span>&#125;&#125;</span><br><span class="line">    ref=&#123;search =&gt; (<span class="keyword">this</span>.search = search)&#125;</span><br><span class="line">    platform=<span class="string">"ios"</span></span><br><span class="line">    containerStyle=&#123;&#123;<span class="attr">backgroundColor</span>: <span class="string">'white'</span>&#125;&#125;</span><br><span class="line">    placeholder=<span class="string">"Search"</span></span><br><span class="line">    showCancel=&#123;<span class="literal">true</span>&#125;</span><br><span class="line">    searchIcon=&#123;<span class="literal">false</span>&#125;</span><br><span class="line">    onChangeText=&#123;searchText =&gt;</span><br><span class="line">      <span class="keyword">this</span>.setState(&#123;searchText&#125;, () =&gt; &#123;</span><br><span class="line">        <span class="keyword">this</span>.searchTypeGetRequest();</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    value=&#123;<span class="keyword">this</span>.state.searchText&#125;</span><br><span class="line">    cancelButtonProps=&#123;&#123;<span class="attr">color</span>: <span class="string">'black'</span>&#125;&#125;</span><br><span class="line">    onCancel=&#123;() =&gt; &#123;</span><br><span class="line">      <span class="keyword">this</span>.props.navigation.goBack();</span><br><span class="line">    &#125;&#125;</span><br><span class="line">    returnKeyType=<span class="string">"search"</span></span><br><span class="line">    onFocus=&#123;() =&gt; &#123;</span><br><span class="line">      <span class="keyword">this</span>.setState(<span class="function"><span class="params">prevState</span> =&gt;</span> (&#123;</span><br><span class="line">        LookbookStreetSnapFlatList: <span class="literal">false</span>,</span><br><span class="line">      &#125;));</span><br><span class="line">    &#125;&#125;</span><br><span class="line">    onClear=&#123;() =&gt; &#123;</span><br><span class="line">      <span class="keyword">this</span>.setState(<span class="function"><span class="params">prevState</span> =&gt;</span> (&#123;</span><br><span class="line">        LookbookStreetSnapFlatList: <span class="literal">false</span>,</span><br><span class="line">      &#125;));</span><br><span class="line">      <span class="keyword">this</span>.search.focus();</span><br><span class="line">    &#125;&#125;</span><br><span class="line">    onSubmitEditing=&#123;() =&gt; &#123;</span><br><span class="line">       <span class="comment">// press the search button, something will be happened</span></span><br><span class="line">    &#125;&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>
<p>If you use  <code>this.search.focus()</code>, you can find a bug when you use iOS device. when you inter the search page, you click the cancel button, the keyboard always be there and didn’t dismiss anytime. So you can use setTimeout void to avoid that action.</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;SearchBar</span><br><span class="line">  ref=&#123;search =&gt; <span class="keyword">this</span>.search = search&#125;</span><br><span class="line">  ...</span><br><span class="line">/&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (Platform.OS === <span class="string">'ios'</span>) &#123;</span><br><span class="line">  <span class="keyword">this</span>.timer = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.search.focus();</span><br><span class="line">  &#125;, <span class="number">200</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">this</span>.search.focus();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>About the other detail , you can check the API from RN element library website: </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://leviduan.com/2020/01/08/2020-01-08-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Levi Duan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Levi's blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/08/2020-01-08-1/" itemprop="url">Week Tips | 2019.12.23 - 2019.12.27</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-08T22:30:01+08:00">
                2020-01-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web/" itemprop="url" rel="index">
                    <span itemprop="name">web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/01/08/2020-01-08-1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/01/08/2020-01-08-1/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="Q1-Android-studio-Error-“Unsupported-Modules-Detected-Compilation-is-not-supported-for-following-modules”"><a href="#Q1-Android-studio-Error-“Unsupported-Modules-Detected-Compilation-is-not-supported-for-following-modules”" class="headerlink" title="Q1 :  Android studio Error “Unsupported Modules Detected: Compilation is not supported for following modules”"></a>Q1 :  Android studio Error “Unsupported Modules Detected: Compilation is not supported for following modules”</h4><ol>
<li>File -&gt; Invalidate Caches / Restart -&gt; Invalidate Caches &amp; Restart.</li>
<li>close Android Studio IDE and delete the <code>.idea</code> directory.</li>
<li>delete all .iml files</li>
<li>open Android Studio IDE and Sync with <code>Gradle</code>.</li>
</ol>
<h4 id="Q2-React-Native-iOS-StatusBar-background-colour-is-not-dark-in-the-dark-mode"><a href="#Q2-React-Native-iOS-StatusBar-background-colour-is-not-dark-in-the-dark-mode" class="headerlink" title="Q2 :  React Native iOS StatusBar background colour is not dark in the dark mode."></a>Q2 :  React Native iOS StatusBar background colour is not dark in the dark mode.</h4><p>we will change the file about react native library</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">RCT_ENUM_CONVERTER(<span class="built_in">UIStatusBarStyle</span>, (@&#123;</span><br><span class="line">  <span class="string">@"default"</span>: @(<span class="built_in">UIStatusBarStyleDefault</span>), </span><br><span class="line">  <span class="string">@"light-content"</span>: @(<span class="built_in">UIStatusBarStyleLightContent</span>), </span><br><span class="line">  <span class="string">@"dark-content"</span>: @(@available(iOS <span class="number">13.0</span>, *) ? <span class="built_in">UIStatusBarStyleDarkContent</span> : <span class="built_in">UIStatusBarStyleDefault</span>), </span><br><span class="line">&#125;), <span class="built_in">UIStatusBarStyleDefault</span>, integerValue);</span><br></pre></td></tr></table></figure>
<h4 id="Q3-React-native-share-library-question-Currently-on-iOS-13-the-app-will-crash"><a href="#Q3-React-native-share-library-question-Currently-on-iOS-13-the-app-will-crash" class="headerlink" title="Q3 : React native share library question - Currently on iOS 13 the app will crash"></a>Q3 : React native share library question - Currently on iOS 13 the app will crash</h4><p>Currently on iOS 13 the app will crash if you:</p>
<ul>
<li>Open the share sheet</li>
<li>Tap something like messages or photos</li>
<li>Cancel the dialog</li>
<li>Perform any other action</li>
</ul>
<p>This is because shareController.completionWithItemsHandler is called when the dialog box is canceled and currently failureCallback or successCallback will always be called. In the situation above, activityError is nil so successCallback will be called even though completed is false. This leaves us in a state where the callback has been invoked but the ShareSheet is still active, meaning the success or error callback will be invoked again, leading to the crash.</p>
<p>This PR adds a check to make sure completed is true before calling successCallback. This way successCallback will only be called when the user has successfully completed an action and the ShareSheet is closed.</p>
<p>Only call successCallback when completed is true (iOS 13 crash)</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">shareController.completionWithItemsHandler = ^(<span class="built_in">NSString</span> *activityType, <span class="built_in">BOOL</span> completed, __unused <span class="built_in">NSArray</span> *returnedItems, <span class="built_in">NSError</span> *activityError) &#123;</span><br><span class="line">    <span class="keyword">if</span> (activityError) &#123;</span><br><span class="line">        failureCallback(activityError);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (completed) &#123;</span><br><span class="line">        successCallback(@[@(completed), RCTNullIfNil(activityType)]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="Q4-The-question-about-React-native-share-Android-release-build-doesn’t-work-with-react-native-0-60"><a href="#Q4-The-question-about-React-native-share-Android-release-build-doesn’t-work-with-react-native-0-60" class="headerlink" title="Q4 :  The question about React native share - Android release build doesn’t work with react-native@0.60"></a>Q4 :  The question about React native share - Android release build doesn’t work with <a href="mailto:react-native@0.60" target="_blank" rel="noopener">react-native@0.60</a></h4><p>You can run <code>npx jetify</code> in the current react native directory on the terminal.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://leviduan.com/2020/01/08/2020-01-08-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Levi Duan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Levi's blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/08/2020-01-08-2/" itemprop="url">Week Tips | 2019.12.30 - 2019.01.03</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-08T22:30:01+08:00">
                2020-01-08
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web/" itemprop="url" rel="index">
                    <span itemprop="name">web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/01/08/2020-01-08-2/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2020/01/08/2020-01-08-2/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="Q1-react-native-vector-icons-iOS-run-error-‘Multiple-commands-produce’-error-when-building-with-new-Xcode-build-system"><a href="#Q1-react-native-vector-icons-iOS-run-error-‘Multiple-commands-produce’-error-when-building-with-new-Xcode-build-system" class="headerlink" title="Q1 : react-native-vector-icons iOS run error - ‘Multiple commands produce’ error when building with new Xcode build system"></a>Q1 : react-native-vector-icons iOS run error - ‘Multiple commands produce’ error when building with new Xcode build system</h4><p>The solution way : <strong>simply remove duplicate reference fonts in “Copy Bundle Resources” NOT in “[CP] Copy Pods Resources”</strong></p>
<p>You can correct to run iOS app.</p>
<p>The problem seems to be caused by the new autolinking feature in React Native 0.60 - the line use_native_modules! in ios/Podfile means when you do pod install, any pods found in node_modules are automatically linked. This means that links to all font files are added to [CP] Copy Pods Resources when you do pod install.</p>
<p>If you previously installed react-native-vector-icons manually by adding the font files to Copy Bundle Resources, you then get a “Multiple commands produce…” fatal build error.</p>
<p>So to fix the problem, just remove the font files from Copy Bundle Resources, so that they are only in [CP] Copy Pods Resources.</p>
<h4 id="Q2-How-can-I-insert-a-line-break-into-a-component-in-React-Native"><a href="#Q2-How-can-I-insert-a-line-break-into-a-component-in-React-Native" class="headerlink" title="Q2 : How can I insert a line break into a  component in React Native?"></a>Q2 : How can I insert a line break into a <text> component in React Native?</text></h4><p>This should do it:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&lt;Text&gt;</span><br><span class="line">Hi~&#123;<span class="string">"\n"</span>&#125;</span><br><span class="line"><span class="keyword">this</span> is a test message.</span><br><span class="line">&lt;<span class="regexp">/Text&gt;</span></span><br></pre></td></tr></table></figure>
<p>{“\n”} can be used in the <text> component in React Native.</text></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://leviduan.com/2019/09/19/2019-09-19-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Levi Duan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Levi's blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/19/2019-09-19-1/" itemprop="url">2019 W1 | 9.16-9.22 | Tips Week Summary</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-19T22:51:18+08:00">
                2019-09-19
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/09/19/2019-09-19-1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/09/19/2019-09-19-1/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Q1-Make-a-drop-shadow-effect-on-a-label-in-Swift"><a href="#Q1-Make-a-drop-shadow-effect-on-a-label-in-Swift" class="headerlink" title="Q1 Make a drop shadow effect on a label in Swift"></a>Q1 Make a drop shadow effect on a label in Swift</h3><p>Show my code:</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="built_in">lazy</span> <span class="keyword">var</span> titleLabel: <span class="type">UILabel</span> = &#123;</span><br><span class="line">    <span class="keyword">let</span> titleLabel = <span class="type">UILabel</span>(frame: .zero)</span><br><span class="line">    titleLabel.textAlignment = .center</span><br><span class="line">    titleLabel.lineBreakMode = .byTruncatingTail</span><br><span class="line">    titleLabel.numberOfLines = <span class="number">2</span></span><br><span class="line">    titleLabel.font = <span class="type">DJFont</span>.boldHelveticaFont(ofSize: <span class="number">40</span>)</span><br><span class="line">    titleLabel.text = <span class="string">" "</span></span><br><span class="line">    titleLabel.textColor = <span class="type">UIColor</span>(fromHexString: <span class="string">"FFFFFF"</span>)</span><br><span class="line">    titleLabel.layer.shadowColor = <span class="type">UIColor</span>.black.cgColor</span><br><span class="line">    titleLabel.layer.shadowRadius = <span class="number">2.0</span></span><br><span class="line">    titleLabel.layer.shadowOpacity = <span class="number">0.3</span></span><br><span class="line">    titleLabel.layer.shadowOffset = <span class="type">CGSize</span>(width: <span class="number">4</span>, height: <span class="number">4</span>)</span><br><span class="line">    titleLabel.layer.masksToBounds = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">return</span> titleLabel</span><br><span class="line">&#125;()</span><br></pre></td></tr></table></figure>
<h3 id="Q2-What’s-different-between-string-utf16-count-and-string-count"><a href="#Q2-What’s-different-between-string-utf16-count-and-string-count" class="headerlink" title="Q2 What’s different between string.utf16.count and string.count?"></a>Q2 What’s different between string.utf16.count and string.count?</h3><p>if you are coding by objective-c, it’s the same, but by swift, it’s really different.</p>
<p>There is a good example :</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">extension String &#123;</span><br><span class="line">    var length: Int &#123;</span><br><span class="line">        return self.utf16.count</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">let emoji = “😆😆😆😆😆😆”</span><br><span class="line">emoji.length // return 12</span><br><span class="line">emoji.count // return 6</span><br></pre></td></tr></table></figure>
<p>If you print by string.utf16.count, return 12.<br>but you print by string.count, return 6.</p>
<p>Does you make sense?</p>
<h3 id="Q3-How-to-increase-line-spacing-in-UILabel-in-swift"><a href="#Q3-How-to-increase-line-spacing-in-UILabel-in-swift" class="headerlink" title="Q3 How to increase line spacing in UILabel in swift"></a>Q3 How to increase line spacing in UILabel in swift</h3><p>You can use it by label instance</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> label = <span class="type">UILabel</span>()</span><br><span class="line"><span class="keyword">let</span> stringValue = <span class="string">"Levi\nCherry\nMandy\n"</span></span><br><span class="line"><span class="keyword">let</span> attrString = <span class="type">NSMutableAttributedString</span>(string: stringValue)</span><br><span class="line"><span class="keyword">var</span> style = <span class="type">NSMutableParagraphStyle</span>()</span><br><span class="line">style.lineSpacing = <span class="number">24</span> <span class="comment">// change line spacing between paragraph like 36 or 48</span></span><br><span class="line">style.minimumLineHeight = <span class="number">20</span> <span class="comment">// change line spacing between each line like 30 or 40</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Line spacing attribute</span></span><br><span class="line">attrString.addAttribute(<span class="type">NSAttributedStringKey</span>.paragraphStyle, value: style, range: <span class="type">NSRange</span>(location: <span class="number">0</span>, length: stringValue.characters.<span class="built_in">count</span>))</span><br><span class="line"></span><br><span class="line">label.attributedText = attrString</span><br></pre></td></tr></table></figure>
<h3 id="Q4-No-Accounts-with-iTunes-Connect-have-been-found-for-the-Team"><a href="#Q4-No-Accounts-with-iTunes-Connect-have-been-found-for-the-Team" class="headerlink" title="Q4 No Accounts with iTunes Connect have been found for the Team?"></a>Q4 No Accounts with iTunes Connect have been found for the Team?</h3><p>I am going to submit my App to App Store, but I am getting the error:</p>
<p>“No accounts with iTunes Connect access have been found for the team…”</p>
<p>And I resolved by stackoverflow:</p>
<p>Quit Xcode completely and re-open it to resolve the problem.</p>
<p>Or</p>
<ol>
<li>Please verify if it’s App Store distribution profile or not.</li>
<li>If yes then try to login to Xcode with your apple Id which has access to iTunes Connect or App Store Connect.</li>
<li>While validating the archive file please choose the same profile. It should work fine.</li>
</ol>
<p>I resolved it by first way.</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://leviduan.com/2019/09/19/2019-09-19/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Levi Duan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Levi's blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/19/2019-09-19/" itemprop="url">How to Add "…Read More" to the end of UILabel</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-19T22:50:18+08:00">
                2019-09-19
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/09/19/2019-09-19/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/09/19/2019-09-19/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="Product-Requirements"><a href="#Product-Requirements" class="headerlink" title="Product Requirements"></a>Product Requirements</h3><p>There is a UILabel, the number of line are three, if the content is more than content in the UILabel, you have to add “… more” to the end of UILabel, and then you can click the text, the UILabel will be unfolded. </p>
<p>just like this pic below : </p>
<p><img src="https://i.stack.imgur.com/8Bq7I.png" alt="pic"></p>
<h3 id="How-to-solve-it"><a href="#How-to-solve-it" class="headerlink" title="How to solve it"></a>How to solve it</h3><p>At first, I want to calculate the visible text I can put into this UILabel with the current UILabel size by this fitString function.</p>
<p>When I get this visible text, and then I will prepare visible text and all UILabel’s text, if this count is the same, I will display it all text, if not I will display the visible text which will replace the last 8 character with “… more”.</p>
<p>I think that this method will resolve most question just like this, but there is a question, if the string just like this: “123\n345\n234\n123\n”, the last 8 character will be replace with “… more”, however, this is wrong, the correct way is that you won’t replace 8 character, just add “… more” to the end of visible text. The correct final string is </p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">123</span><br><span class="line">123</span><br><span class="line">123 ...more</span><br></pre></td></tr></table></figure>
<p>And then I resolve it, but unexpectedly, if the string included some Emoji characters, the visible text characters will be wrong, so you will find some bug in the fitString function.</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line">- (<span class="built_in">NSUInteger</span>)fitString:(<span class="built_in">NSString</span> *)string intoLabel:(<span class="built_in">UILabel</span> *)label</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">UIFont</span> *font           = label.font;</span><br><span class="line">    <span class="built_in">NSLineBreakMode</span> mode   = label.lineBreakMode;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">CGFloat</span> labelWidth     = label.frame.size.width;</span><br><span class="line">    <span class="built_in">CGFloat</span> labelHeight    = label.frame.size.height;</span><br><span class="line">    <span class="built_in">CGSize</span>  sizeConstraint = <span class="built_in">CGSizeMake</span>(labelWidth, <span class="built_in">CGFLOAT_MAX</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (SYSTEM_VERSION_GREATER_THAN(iOS_7))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">NSDictionary</span> *attributes = @&#123; <span class="built_in">NSFontAttributeName</span> : font &#125;;</span><br><span class="line">        <span class="built_in">NSAttributedString</span> *attributedText = [[<span class="built_in">NSAttributedString</span> alloc] initWithString:string attributes:attributes];</span><br><span class="line">        <span class="built_in">CGRect</span> boundingRect = [attributedText boundingRectWithSize:sizeConstraint options:<span class="built_in">NSStringDrawingUsesLineFragmentOrigin</span> context:<span class="literal">nil</span>];</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (boundingRect.size.height &gt; labelHeight)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">NSUInteger</span> index = <span class="number">0</span>;</span><br><span class="line">                <span class="built_in">NSUInteger</span> prev;</span><br><span class="line">                <span class="built_in">NSCharacterSet</span> *characterSet = [<span class="built_in">NSCharacterSet</span> whitespaceAndNewlineCharacterSet];</span><br><span class="line"></span><br><span class="line">                <span class="keyword">do</span></span><br><span class="line">                &#123;</span><br><span class="line">                    prev = index;</span><br><span class="line">                    <span class="keyword">if</span> (mode == <span class="built_in">NSLineBreakByCharWrapping</span>)</span><br><span class="line">                        index++;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        index = [string rangeOfCharacterFromSet:characterSet options:<span class="number">0</span> range:<span class="built_in">NSMakeRange</span>(index + <span class="number">1</span>, [string length] - index - <span class="number">1</span>)].location;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">while</span> (index != <span class="built_in">NSNotFound</span> &amp;&amp; index &lt; [string length] &amp;&amp; [[string substringToIndex:index] boundingRectWithSize:sizeConstraint options:<span class="built_in">NSStringDrawingUsesLineFragmentOrigin</span> attributes:attributes context:<span class="literal">nil</span>].size.height &lt;= labelHeight);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> prev;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> ([string sizeWithFont:font constrainedToSize:sizeConstraint lineBreakMode:mode].height &gt; labelHeight)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">NSUInteger</span> index = <span class="number">0</span>;</span><br><span class="line">            <span class="built_in">NSUInteger</span> prev;</span><br><span class="line">            <span class="built_in">NSCharacterSet</span> *characterSet = [<span class="built_in">NSCharacterSet</span> whitespaceAndNewlineCharacterSet];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">do</span></span><br><span class="line">            &#123;</span><br><span class="line">                prev = index;</span><br><span class="line">                <span class="keyword">if</span> (mode == <span class="built_in">NSLineBreakByCharWrapping</span>)</span><br><span class="line">                    index++;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    index = [string rangeOfCharacterFromSet:characterSet options:<span class="number">0</span> range:<span class="built_in">NSMakeRange</span>(index + <span class="number">1</span>, [string length] - index - <span class="number">1</span>)].location;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (index != <span class="built_in">NSNotFound</span> &amp;&amp; index &lt; [string length] &amp;&amp; [[string substringToIndex:index] sizeWithFont:font constrainedToSize:sizeConstraint lineBreakMode:mode].height &lt;= labelHeight);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> prev;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [string length];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Do you find it? </p>
<h3 id="Show-my-code"><a href="#Show-my-code" class="headerlink" title="Show my code"></a>Show my code</h3><figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UILabel</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">addTrailing</span><span class="params">(with trailingText: String, moreText: String, moreTextFont: UIFont, moreTextColor: UIColor)</span></span> &#123;</span><br><span class="line">        <span class="keyword">let</span> readMoreText: <span class="type">String</span> = trailingText + moreText</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> lengthForVisibleString: <span class="type">Int</span> = <span class="keyword">self</span>.vissibleTextLength</span><br><span class="line">        <span class="keyword">let</span> mutableString: <span class="type">String</span> = <span class="keyword">self</span>.text!</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> trimmedString: <span class="type">String</span>? = (mutableString <span class="keyword">as</span> <span class="type">NSString</span>).substring(to: lengthForVisibleString)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> ((<span class="keyword">self</span>.text?.<span class="built_in">count</span>)! - lengthForVisibleString) &lt;= <span class="number">0</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> style = <span class="type">NSMutableParagraphStyle</span>()</span><br><span class="line">            style.lineSpacing = <span class="number">4.0</span> <span class="comment">// change line spacing between paragraph like 36 or 48</span></span><br><span class="line">            <span class="keyword">let</span> answerAttributed = <span class="type">NSMutableAttributedString</span>(string: <span class="keyword">self</span>.text!, attributes: [<span class="type">NSAttributedString</span>.<span class="type">Key</span>.font: <span class="keyword">self</span>.font, <span class="type">NSAttributedString</span>.<span class="type">Key</span>.paragraphStyle: style])</span><br><span class="line">            <span class="keyword">self</span>.attributedText = answerAttributed</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> leviTrimmedForReadMore = <span class="type">String</span>(trimmedString ?? <span class="string">""</span>) + <span class="type">String</span>(<span class="string">"... more"</span>)</span><br><span class="line">        <span class="keyword">self</span>.text = leviTrimmedForReadMore</span><br><span class="line">        <span class="keyword">let</span> ddlengthForVisibleString: <span class="type">Int</span> = <span class="keyword">self</span>.vissibleTextLength</span><br><span class="line">        <span class="keyword">if</span> ((<span class="keyword">self</span>.text?.<span class="built_in">count</span>)! - ddlengthForVisibleString) &lt;= <span class="number">0</span> &#123;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">let</span> trimmedForReadMore: <span class="type">String</span> = trimmedString! + trailingText</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">let</span> style = <span class="type">NSMutableParagraphStyle</span>()</span><br><span class="line">            style.lineSpacing = <span class="number">4.0</span> <span class="comment">// change line spacing between paragraph like 36 or 48</span></span><br><span class="line">            <span class="keyword">let</span> answerAttributed = <span class="type">NSMutableAttributedString</span>(string: trimmedForReadMore, attributes: [<span class="type">NSAttributedString</span>.<span class="type">Key</span>.font: <span class="keyword">self</span>.font, <span class="type">NSAttributedString</span>.<span class="type">Key</span>.paragraphStyle: style])</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">let</span> readMoreAttributed = <span class="type">NSMutableAttributedString</span>(string: moreText, attributes: [<span class="type">NSAttributedString</span>.<span class="type">Key</span>.font: moreTextFont, <span class="type">NSAttributedString</span>.<span class="type">Key</span>.foregroundColor: moreTextColor, <span class="type">NSAttributedString</span>.<span class="type">Key</span>.paragraphStyle: style])</span><br><span class="line">            </span><br><span class="line">            answerAttributed.append(readMoreAttributed)</span><br><span class="line">            <span class="keyword">self</span>.attributedText = answerAttributed</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">let</span> readMoreLength: <span class="type">Int</span> = (readMoreText.utf16.<span class="built_in">count</span>)</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">let</span> trimmedForReadMore: <span class="type">String</span> = (trimmedString! <span class="keyword">as</span> <span class="type">NSString</span>).substring(to: (trimmedString?.utf16.<span class="built_in">count</span> ?? <span class="number">0</span>) - readMoreLength) + trailingText</span><br><span class="line">            <span class="keyword">let</span> style = <span class="type">NSMutableParagraphStyle</span>()</span><br><span class="line">            style.lineSpacing = <span class="number">4.0</span> <span class="comment">// change line spacing between paragraph like 36 or 48</span></span><br><span class="line">            </span><br><span class="line">            <span class="keyword">let</span> answerAttributed = <span class="type">NSMutableAttributedString</span>(string: trimmedForReadMore, attributes: [<span class="type">NSAttributedString</span>.<span class="type">Key</span>.font: <span class="keyword">self</span>.font, <span class="type">NSAttributedString</span>.<span class="type">Key</span>.paragraphStyle: style])</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">let</span> readMoreAttributed = <span class="type">NSMutableAttributedString</span>(string: moreText, attributes: [<span class="type">NSAttributedString</span>.<span class="type">Key</span>.font: moreTextFont, <span class="type">NSAttributedString</span>.<span class="type">Key</span>.foregroundColor: moreTextColor, <span class="type">NSAttributedString</span>.<span class="type">Key</span>.paragraphStyle: style])</span><br><span class="line">            </span><br><span class="line">            answerAttributed.append(readMoreAttributed)</span><br><span class="line">            <span class="keyword">self</span>.attributedText = answerAttributed</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> vissibleTextLength: <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> font: <span class="type">UIFont</span> = <span class="keyword">self</span>.font</span><br><span class="line">        <span class="keyword">let</span> mode: <span class="type">NSLineBreakMode</span> = <span class="keyword">self</span>.lineBreakMode</span><br><span class="line">        <span class="keyword">let</span> labelWidth: <span class="type">CGFloat</span> = <span class="keyword">self</span>.frame.size.width</span><br><span class="line">        <span class="keyword">let</span> labelHeight: <span class="type">CGFloat</span> = <span class="keyword">self</span>.frame.size.height</span><br><span class="line">        <span class="keyword">let</span> sizeConstraint = <span class="type">CGSize</span>(width: labelWidth, height: <span class="type">CGFloat</span>.greatestFiniteMagnitude)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">let</span> attributes: [<span class="type">AnyHashable</span>: <span class="type">Any</span>] = [<span class="type">NSAttributedString</span>.<span class="type">Key</span>.font: font]</span><br><span class="line">        <span class="keyword">let</span> attributedText = <span class="type">NSAttributedString</span>(string: <span class="keyword">self</span>.text!, attributes: attributes <span class="keyword">as</span>? [<span class="type">NSAttributedString</span>.<span class="type">Key</span> : <span class="type">Any</span>])</span><br><span class="line">        <span class="keyword">let</span> boundingRect: <span class="type">CGRect</span> = attributedText.boundingRect(with: sizeConstraint, options: .usesLineFragmentOrigin, context: <span class="literal">nil</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> boundingRect.size.height &gt; labelHeight &#123;</span><br><span class="line">            <span class="keyword">var</span> index: <span class="type">Int</span> = <span class="number">0</span></span><br><span class="line">            <span class="keyword">var</span> prev: <span class="type">Int</span> = <span class="number">0</span></span><br><span class="line">            <span class="keyword">let</span> characterSet = <span class="type">CharacterSet</span>.whitespacesAndNewlines</span><br><span class="line">            <span class="keyword">repeat</span> &#123;</span><br><span class="line">                prev = index</span><br><span class="line">                <span class="keyword">if</span> mode == <span class="type">NSLineBreakMode</span>.byCharWrapping &#123;</span><br><span class="line">                    index += <span class="number">1</span></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    index = (<span class="keyword">self</span>.text! <span class="keyword">as</span> <span class="type">NSString</span>).rangeOfCharacter(from: characterSet, options: [], range: <span class="type">NSRange</span>(location: index + <span class="number">1</span>, length: <span class="keyword">self</span>.text!.<span class="built_in">count</span> - index - <span class="number">1</span>)).location</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; <span class="keyword">while</span> index != <span class="type">NSNotFound</span> &amp;&amp; index &lt; <span class="keyword">self</span>.text!.<span class="built_in">count</span> &amp;&amp; (<span class="keyword">self</span>.text! <span class="keyword">as</span> <span class="type">NSString</span>).substring(to: index).boundingRect(with: sizeConstraint, options: .usesLineFragmentOrigin, attributes: attributes <span class="keyword">as</span>? [<span class="type">NSAttributedString</span>.<span class="type">Key</span> : <span class="type">Any</span>], context: <span class="literal">nil</span>).size.height &lt;= labelHeight</span><br><span class="line">            <span class="keyword">return</span> prev</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.text!.<span class="built_in">count</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//You can use it</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> biography = model.biography &#123;</span><br><span class="line">    <span class="keyword">if</span> biography.<span class="built_in">count</span> &gt;= <span class="number">10</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> readmoreFont = <span class="type">DJFont</span>.lightHelveticaFont(ofSize: <span class="number">16.0</span>)</span><br><span class="line">        <span class="keyword">let</span> readmoreFontColor = <span class="type">UIColor</span>(fromHexString: <span class="string">"818181"</span>)</span><br><span class="line">        <span class="keyword">self</span>.contentLabel.addTrailing(with: <span class="string">"... "</span>, moreText: <span class="string">"more"</span>, moreTextFont: readmoreFont!, moreTextColor: readmoreFontColor!)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://leviduan.com/2019/04/07/2019-04-07-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Levi Duan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Levi's blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/07/2019-04-07-1/" itemprop="url">Week Tips(2019.4.1-2019.4.7)</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-07T16:26:18+08:00">
                2019-04-07
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web/" itemprop="url" rel="index">
                    <span itemprop="name">web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/04/07/2019-04-07-1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/04/07/2019-04-07-1/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="H5-react增加loading页面"><a href="#H5-react增加loading页面" class="headerlink" title="H5 react增加loading页面"></a>H5 react增加loading页面</h3><h4 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件:"></a>安装插件:</h4><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm i react-loading  --save</span><br></pre></td></tr></table></figure>
<p>npm web:<br><a href="https://www.npmjs.com/package/react-loading" target="_blank" rel="noopener">https://www.npmjs.com/package/react-loading</a></p>
<h4 id="Demo展示页面"><a href="#Demo展示页面" class="headerlink" title="Demo展示页面:"></a>Demo展示页面:</h4><p><a href="https://codesandbox.io/s/mqx0ql55qp" target="_blank" rel="noopener">https://codesandbox.io/s/mqx0ql55qp</a></p>
<h4 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法:"></a>使用方法:</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ReactLoading</span> <span class="attr">type</span>=<span class="string">'spokes'</span> <span class="attr">color</span>=<span class="string">"#262729"</span> <span class="attr">height</span>=<span class="string">"0.3rem"</span> <span class="attr">width</span>=<span class="string">"0.3rem"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="loading样式"><a href="#loading样式" class="headerlink" title="loading样式:"></a>loading样式:</h4><p><img src="/images/15546126208728/15546136593422.jpg" alt></p>
<h4 id="模拟iOS-loading样式"><a href="#模拟iOS-loading样式" class="headerlink" title="模拟iOS loading样式:"></a>模拟iOS loading样式:</h4><p>html:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"SnsRankOther-loadingPic"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ReactLoading</span> <span class="attr">type</span>=<span class="string">'spokes'</span> <span class="attr">color</span>=<span class="string">"#262729"</span> <span class="attr">height</span>=<span class="string">"0.3rem"</span> <span class="attr">width</span>=<span class="string">"0.3rem"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>css:</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.SnsRankOther-loadingPic</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(230, 230, 230, 0.479);</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0.8rem</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">0.8rem</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">0.05rem</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: row;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>效果:</p>
<p><img src="/images/15546126208728/15546139826383.jpg" alt></p>
<h3 id="iOS-pod-update后React-framework报错"><a href="#iOS-pod-update后React-framework报错" class="headerlink" title="iOS pod update后React framework报错"></a>iOS pod update后React framework报错</h3><p>问题出现: npm install 后 podupdate， Xcode运行报错，错误提示 React google::logmessage出题。</p>
<h4 id="编译报错提示："><a href="#编译报错提示：" class="headerlink" title="编译报错提示："></a>编译报错提示：</h4><p><img src="/images/15546126208728/15546141634870.png" alt></p>
<p>log:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Undefined symbols for architecture x86_64:</span><br><span class="line">  &quot;google::LogMessage::LogMessage(char const*, int, int)&quot;, referenced from:</span><br><span class="line">      facebook::react::CxxNativeModule::invoke(unsigned int, folly::dynamic&amp;&amp;, int)::$_1::operator()() const in CxxNativeModule.o</span><br><span class="line">      facebook::react::JSException::buildMessage(OpaqueJSContext const*, OpaqueJSValue const*, OpaqueJSString*, char const*) in JSCHelpers.o</span><br><span class="line">  &quot;double_conversion::DoubleToStringConverter::ToShortestIeeeNumber(double, double_conversion::StringBuilder*, double_conversion::DoubleToStringConverter::DtoaMode) const&quot;, referenced from:</span><br><span class="line">      double_conversion::DoubleToStringConverter::ToShortest(double, double_conversion::StringBuilder*) const in CxxNativeModule.o</span><br><span class="line">  &quot;double_conversion::DoubleToStringConverter::ToFixed(double, int, double_conversion::StringBuilder*) const&quot;, referenced from:</span><br><span class="line">      std::__1::enable_if&lt;(std::is_floating_point&lt;double&gt;::value) &amp;&amp; (IsSomeString&lt;std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt; &gt;::value), void&gt;::type folly::toAppend&lt;std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;, double&gt;(double, std::__1::basic_string&lt;char, std::__1::char_traits&lt;char&gt;, std::__1::allocator&lt;char&gt; &gt;*, double_conversion::DoubleToStringConverter::DtoaMode, unsigned int) in CxxNativeModule.o</span><br><span class="line">      ...</span><br></pre></td></tr></table></figure>
<h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案:"></a>解决方案:</h4><p>working manually adding DoubleConversion and glog to Link Binary With Libraries of React framework target in @CocoaPods project.</p>
<p><img src="/images/15546126208728/15546142677714.png" alt></p>
<h3 id="UITableView回滚到顶部的几种方法"><a href="#UITableView回滚到顶部的几种方法" class="headerlink" title="UITableView回滚到顶部的几种方法"></a>UITableView回滚到顶部的几种方法</h3><p>问题: tableview每次回滚是滚到了第一个cell上面，但这个tableview是有表头的。</p>
<p>看了下代码:</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">self</span>.tableview.scrollToRow(at: <span class="type">IndexPath</span>(row: <span class="number">0</span>, section: <span class="number">0</span>), at: .top, animated: <span class="literal">true</span>)</span><br></pre></td></tr></table></figure>
<p>改成如下方式:</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">self</span>.contentTB.setContentOffset(<span class="type">CGPoint</span>(x: <span class="number">0</span>, y: <span class="number">0</span>), animated: <span class="literal">true</span>)</span><br></pre></td></tr></table></figure>
<p>问题解决</p>
<p>UITableView回滚到顶部的几个方法：</p>
<figure class="highlight objectivec"><table><tr><td class="code"><pre><span class="line"><span class="comment">//方法一</span></span><br><span class="line">[<span class="keyword">self</span>.tableView  scrollRectToVisible:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>) animated:<span class="literal">NO</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//方法二</span></span><br><span class="line">[<span class="keyword">self</span>.tableView setContentOffset:<span class="built_in">CGPointMake</span>(<span class="number">0</span>,<span class="number">0</span>) animated:<span class="literal">NO</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//方法三</span></span><br><span class="line"><span class="built_in">NSIndexPath</span>* indexPat = [<span class="built_in">NSIndexPath</span> indexPathForRow:<span class="number">0</span> inSection:<span class="number">0</span>];</span><br><span class="line">[<span class="keyword">self</span>.tableView scrollToRowAtIndexPath:indexPat atScrollPosition:<span class="built_in">UITableViewScrollPositionBottom</span> animated:<span class="literal">YES</span>];</span><br></pre></td></tr></table></figure>
<p>方法一可以回滚到表头，其他两个方法只是回滚到第一个cell.</p>
<h3 id="iOS通过Safari调试H5"><a href="#iOS通过Safari调试H5" class="headerlink" title="iOS通过Safari调试H5"></a>iOS通过Safari调试H5</h3><h4 id="通过数据线，将手机连接电脑"><a href="#通过数据线，将手机连接电脑" class="headerlink" title="通过数据线，将手机连接电脑"></a>通过数据线，将手机连接电脑</h4><h4 id="打开手机，-Settings-safari-Advanced-Web-Inspector-开关打开"><a href="#打开手机，-Settings-safari-Advanced-Web-Inspector-开关打开" class="headerlink" title="打开手机， Settings - safari - Advanced - Web Inspector 开关打开"></a>打开手机， Settings - safari - Advanced - Web Inspector 开关打开</h4><h4 id="打开电脑safari，preference-Advanced-Show-Develop-menu-in-menu-bar-开关打开-如图"><a href="#打开电脑safari，preference-Advanced-Show-Develop-menu-in-menu-bar-开关打开-如图" class="headerlink" title="打开电脑safari，preference - Advanced - Show Develop menu in menu bar 开关打开,如图:"></a>打开电脑safari，preference - Advanced - Show Develop menu in menu bar 开关打开,如图:</h4><p><img src="/images/15546126208728/15546152534699.jpg" alt></p>
<h4 id="打开电脑safari-Develop-bar-中会看到你的手机，如图所示，点击进行调试"><a href="#打开电脑safari-Develop-bar-中会看到你的手机，如图所示，点击进行调试" class="headerlink" title="打开电脑safari - Develop bar 中会看到你的手机，如图所示，点击进行调试:"></a>打开电脑safari - Develop bar 中会看到你的手机，如图所示，点击进行调试:</h4><p><img src="/images/15546126208728/15546153459838.jpg" alt></p>
<h4 id="点击web后进入了调试页面，可以进行调试了。"><a href="#点击web后进入了调试页面，可以进行调试了。" class="headerlink" title="点击web后进入了调试页面，可以进行调试了。"></a>点击web后进入了调试页面，可以进行调试了。</h4><p><img src="/images/15546126208728/15546153855792.jpg" alt></p>
<h3 id="JavaScript-获取时间戳转换美国日期简写的方法："><a href="#JavaScript-获取时间戳转换美国日期简写的方法：" class="headerlink" title="JavaScript 获取时间戳转换美国日期简写的方法："></a>JavaScript 获取时间戳转换美国日期简写的方法：</h3><p>需求: 通过服务端传时间戳显示页面如下:</p>
<p><img src="/images/15546126208728/15546161033203.jpg" alt></p>
<p>代码如下, request.data.start_date为时间戳类型，通过js方法转换成美国日期简写的正确的方式</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> startDate = <span class="keyword">new</span> <span class="built_in">Date</span>(request.data.start_date);</span><br><span class="line"><span class="keyword">let</span> startMonth = startDate.toDateString().split(<span class="string">" "</span>)[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">let</span> startDay = startDate.toDateString().split(<span class="string">" "</span>)[<span class="number">2</span>] + <span class="string">'th'</span></span><br><span class="line"><span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>(request.data.end_date);</span><br><span class="line"><span class="keyword">let</span> endDate = <span class="keyword">new</span> <span class="built_in">Date</span>(request.data.end_date);</span><br><span class="line"><span class="keyword">let</span> endMonth = endDate.toDateString().split(<span class="string">" "</span>)[<span class="number">1</span>]</span><br><span class="line"><span class="keyword">let</span> endDay = endDate.toDateString().split(<span class="string">" "</span>)[<span class="number">2</span>] + <span class="string">'th'</span></span><br><span class="line">dateText = startDay + <span class="string">' '</span> + startMonth + <span class="string">' - '</span> + endDay + <span class="string">' '</span> + endMonth</span><br></pre></td></tr></table></figure>
<h3 id="iOS倒计时方法："><a href="#iOS倒计时方法：" class="headerlink" title="iOS倒计时方法："></a>iOS倒计时方法：</h3><p>效果如下:</p>
<p><img src="/images/15546126208728/15546165365762.jpg" alt></p>
<p>代码如下</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">var</span> timer: <span class="type">Timer</span>!</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">var</span> timeFormat = <span class="string">"HH:mm:ss"</span></span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">var</span> diffDate: <span class="type">NSDate</span>!</span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">let</span> date1970 = <span class="type">NSDate</span>(timeIntervalSince1970: <span class="number">0</span>)</span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">var</span> fromDate: <span class="type">NSDate</span> = <span class="type">NSDate</span>()</span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">var</span> currentDate: <span class="type">NSDate</span> = <span class="type">NSDate</span>()</span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">var</span> range: <span class="type">NSRange</span>!</span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">var</span> targetTime: <span class="type">TimeInterval</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">var</span> currentTime: <span class="type">TimeInterval</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">internal</span> <span class="keyword">var</span> endOfTimer: <span class="type">Bool</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> timeCounted &gt;= currentTime</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">var</span> timeCounted: <span class="type">TimeInterval</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> timeCounted = <span class="type">NSDate</span>().timeIntervalSince(fromDate <span class="keyword">as</span> <span class="type">Date</span>)</span><br><span class="line">    <span class="keyword">return</span> round(timeCounted &lt; <span class="number">0</span> ? <span class="number">0</span> : timeCounted)</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="keyword">public</span> <span class="keyword">var</span> dateFormatter: <span class="type">DateFormatter</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> df = <span class="type">DateFormatter</span>()</span><br><span class="line">    df.locale = <span class="type">Locale</span>(identifier: <span class="string">"zh_CN"</span>)</span><br><span class="line">    df.dateStyle = <span class="type">DateFormatter</span>.<span class="type">Style</span>.medium</span><br><span class="line">    df.timeStyle = <span class="type">DateFormatter</span>.<span class="type">Style</span>.medium</span><br><span class="line">    df.dateFormat = timeFormat</span><br><span class="line">    <span class="keyword">return</span> df</span><br><span class="line">&#125;  </span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">updateTimer</span><span class="params">()</span></span> &#123;</span><br><span class="line">    disposeTimer()</span><br><span class="line">    timer = <span class="type">Timer</span>.scheduledTimer(timeInterval: <span class="number">1.0</span>,</span><br><span class="line">                                 target: <span class="keyword">self</span>,</span><br><span class="line">                                 selector: #selector(updateText),</span><br><span class="line">                                 userInfo: <span class="literal">nil</span>,</span><br><span class="line">                                 repeats: <span class="literal">true</span>)</span><br><span class="line">    <span class="type">RunLoop</span>.current.add(timer, forMode: <span class="type">RunLoop</span>.<span class="type">Mode</span>.common)</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">disposeTimer</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> timer != <span class="literal">nil</span> &#123;</span><br><span class="line">        timer.invalidate()</span><br><span class="line">        timer = <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">updateText</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">guard</span> diffDate != <span class="literal">nil</span> <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> date = diffDate.addingTimeInterval(round(timeCounted * -<span class="number">1</span>)) <span class="keyword">as</span> <span class="type">Date</span></span><br><span class="line">    <span class="keyword">let</span> formattedText = timeCounted &lt; <span class="number">0</span></span><br><span class="line">        ? dateFormatter.string(from: date1970.addingTimeInterval(<span class="number">0</span>) <span class="keyword">as</span> <span class="type">Date</span>)</span><br><span class="line">        : <span class="keyword">self</span>.surplusTime(date)</span><br><span class="line">    </span><br><span class="line">    countdownLabel.text = <span class="string">" - Result will be revealed in "</span> + formattedText</span><br><span class="line">    countdownLabel.sizeToFit()</span><br><span class="line">    </span><br><span class="line">    setNeedsDisplay()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> endOfTimer &#123;</span><br><span class="line">        disposeTimer()</span><br><span class="line">        countdownLabel.text = <span class="string">" "</span></span><br><span class="line">        countdownLabel.sizeToFit()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">surplusTime</span><span class="params">(<span class="number">_</span> to1970Date: Date)</span></span> -&gt; <span class="type">String</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> calendar = <span class="type">Calendar</span>.<span class="keyword">init</span>(identifier: .gregorian);</span><br><span class="line">    <span class="keyword">var</span> labelText = timeFormat;</span><br><span class="line">    <span class="keyword">let</span> comp = calendar.dateComponents([.day, .hour, .minute, .second], from: <span class="type">NSDate</span>(timeIntervalSince1970: <span class="number">0</span>) <span class="keyword">as</span> <span class="type">Date</span>, to: to1970Date)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> day = comp.day ,<span class="keyword">let</span> <span class="number">_</span> = timeFormat.range(of: <span class="string">"dd"</span>)&#123;</span><br><span class="line">        labelText = labelText.replacingOccurrences(of: <span class="string">"dd"</span>, with: <span class="type">String</span>.<span class="keyword">init</span>(format: <span class="string">"%02ld"</span>, day))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> hour = comp.hour ,<span class="keyword">let</span> <span class="number">_</span> = timeFormat.range(of: <span class="string">"hh"</span>)&#123;</span><br><span class="line">        labelText = labelText.replacingOccurrences(of: <span class="string">"hh"</span>, with: <span class="type">String</span>.<span class="keyword">init</span>(format: <span class="string">"%02ld"</span>, hour))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> hour = comp.hour ,<span class="keyword">let</span> <span class="number">_</span> = timeFormat.range(of: <span class="string">"HH"</span>)&#123;</span><br><span class="line">        labelText = labelText.replacingOccurrences(of: <span class="string">"HH"</span>, with: <span class="type">String</span>.<span class="keyword">init</span>(format: <span class="string">"%02ld"</span>, hour))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> minute = comp.minute ,<span class="keyword">let</span> <span class="number">_</span> = timeFormat.range(of: <span class="string">"mm"</span>)&#123;</span><br><span class="line">        labelText = labelText.replacingOccurrences(of: <span class="string">"mm"</span>, with: <span class="type">String</span>.<span class="keyword">init</span>(format: <span class="string">"%02ld"</span>, minute))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> second = comp.second ,<span class="keyword">let</span> <span class="number">_</span> = timeFormat.range(of: <span class="string">"ss"</span>)&#123;</span><br><span class="line">        labelText = labelText.replacingOccurrences(of: <span class="string">"ss"</span>, with: <span class="type">String</span>.<span class="keyword">init</span>(format: <span class="string">"%02ld"</span>, second))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> labelText</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="HTML5-写-REM-js文件方法"><a href="#HTML5-写-REM-js文件方法" class="headerlink" title="HTML5 写 REM.js文件方法"></a>HTML5 写 REM.js文件方法</h3><ol>
<li>复制下面这段代码到你的页面的头部的script标签的最前面。如果是react js，直接放在index.js文件里：</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'./rem.js'</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li><p>根据设计稿大小，调整里面的最后两个参数值。</p>
</li>
<li><p>使用1rem=100px转换你的设计稿的像素，例如设计稿上某个块是100px <em> 300px,换算成rem则为1rem </em> 3rem。</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> win = <span class="built_in">window</span>;</span><br><span class="line"><span class="keyword">var</span> doc = win.document;</span><br><span class="line"><span class="keyword">var</span> docEl = doc.documentElement;</span><br><span class="line"><span class="keyword">var</span> tid;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">refreshRem</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> width = docEl.clientWidth;</span><br><span class="line">    <span class="keyword">var</span> height = docEl.clientHeight;</span><br><span class="line">    <span class="keyword">if</span>(width&gt;=<span class="number">640</span>)&#123;</span><br><span class="line">        docEl.style.fontSize = <span class="string">'100px'</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        docEl.style.fontSize = <span class="number">100</span> * (width / <span class="number">375</span>) + <span class="string">'px'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">win.addEventListener(<span class="string">'resize'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    clearTimeout(tid);</span><br><span class="line">    tid = setTimeout(refreshRem, <span class="number">300</span>);</span><br><span class="line">&#125;, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">win.addEventListener(<span class="string">'pageshow'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (e.persisted) &#123;</span><br><span class="line">        clearTimeout(tid);</span><br><span class="line">        tid = setTimeout(refreshRem, <span class="number">300</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">refreshRem();</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://leviduan.com/2019/04/07/2019-04-07/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Levi Duan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Levi's blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/04/07/2019-04-07/" itemprop="url">React.js/HTML5和iOS双向通信</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-04-07T16:26:18+08:00">
                2019-04-07
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web/" itemprop="url" rel="index">
                    <span itemprop="name">web</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/04/07/2019-04-07/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/04/07/2019-04-07/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近，我使用WKWebView和React.js进行双向通信,自己写了React.js嵌入到Native中。</p>
<h2 id="Native操作Web，通过两种方式传值"><a href="#Native操作Web，通过两种方式传值" class="headerlink" title="Native操作Web，通过两种方式传值"></a>Native操作Web，通过两种方式传值</h2><h3 id="第一种，通过JS传值给Native"><a href="#第一种，通过JS传值给Native" class="headerlink" title="第一种，通过JS传值给Native"></a>第一种，通过JS传值给Native</h3><p>通过这种方式，可以通过Swift执行DOM操作，顺便说一句，webView.evaluateJavaScript返回脚本执行结果的内容。这个处理程序似乎是在主线程上执行的。</p>
<p>Native调用JS代码方法如下:</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">"payResult(true)"</span></span><br><span class="line">    webView.evaluateJavaScript(str) &#123; (result, error) <span class="keyword">in</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>Javascript处理逻辑方法如下:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">payResult = <span class="function"><span class="params">value</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (value === <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'true'</span>)</span><br><span class="line">        <span class="keyword">this</span>.setState(<span class="function"><span class="params">prevState</span> =&gt;</span> (&#123;</span><br><span class="line">            pushnotice: <span class="string">'1'</span></span><br><span class="line">        &#125;));</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'false'</span>)</span><br><span class="line">        <span class="keyword">this</span>.setState(<span class="function"><span class="params">prevState</span> =&gt;</span> (&#123;</span><br><span class="line">            pushnotice: <span class="string">'0'</span></span><br><span class="line">        &#125;));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果JS的payResult方法没有调用，那就加上这样一句话window.payResult，有可能被组件屏蔽无法全局调用。</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="built_in">window</span>.payResult = <span class="keyword">this</span>.payResult</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="第二种，通过get请求传值"><a href="#第二种，通过get请求传值" class="headerlink" title="第二种，通过get请求传值"></a>第二种，通过get请求传值</h3><p>通过get请求方式将参数传到js的请求URL链接中。</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> url = <span class="string">""</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> webUrl = webUrl &#123;</span><br><span class="line">    url = webUrl</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> uid = userID &#123;</span><br><span class="line">        url += <span class="string">"?"</span> + <span class="string">"uid="</span> + uid</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> topicId = topicId &#123;</span><br><span class="line">        url += <span class="string">"&amp;"</span> + <span class="string">"topic="</span> + topicId</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> isRank == <span class="literal">true</span> &#123;</span><br><span class="line">        url += <span class="string">"&amp;"</span> + <span class="string">"type=2"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>react.js通过URL拼接方式解析传递的参数,方法如下:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> params = &#123;&#125;</span><br><span class="line"><span class="keyword">let</span> str = <span class="keyword">this</span>.props.location.search</span><br><span class="line"><span class="keyword">let</span> seg = str.replace(<span class="regexp">/^\?/</span>, <span class="string">''</span>).split(<span class="string">'&amp;'</span>)</span><br><span class="line"><span class="keyword">let</span> len = seg.length</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (seg[i]) &#123;</span><br><span class="line">       <span class="keyword">let</span> p = seg[i].split(<span class="string">'='</span>);</span><br><span class="line">       params[p[<span class="number">0</span>]] = p[<span class="number">1</span>];   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过这种方式params.uid | param.topic | param.type 来获取参数</p>
<h2 id="Native操作Web，通过两种方式传值-1"><a href="#Native操作Web，通过两种方式传值-1" class="headerlink" title="Native操作Web，通过两种方式传值"></a>Native操作Web，通过两种方式传值</h2><h3 id="Native操作"><a href="#Native操作" class="headerlink" title="Native操作"></a>Native操作</h3><ol>
<li>实例化WKWebViewConfiguration和WKUserContentController,userController在JavaScript的注册处理调用名称。并设置实现WKScriptMessageHandler协议的代理。</li>
</ol>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> webConfiguration = <span class="type">WKWebViewConfiguration</span>()</span><br><span class="line">webConfiguration.preferences = <span class="type">WKPreferences</span>()</span><br><span class="line">webConfiguration.preferences.minimumFontSize = <span class="number">10</span>;</span><br><span class="line">webConfiguration.preferences.javaScriptEnabled = <span class="literal">true</span>;</span><br><span class="line">webConfiguration.preferences.javaScriptCanOpenWindowsAutomatically = <span class="literal">false</span>;</span><br><span class="line">webConfiguration.userContentController = <span class="type">WKUserContentController</span>()</span><br><span class="line">webConfiguration.processPool = <span class="type">WKProcessPool</span>()</span><br><span class="line">webConfiguration.userContentController.add(<span class="keyword">self</span> <span class="keyword">as</span> <span class="type">WKScriptMessageHandler</span>, name:<span class="string">"pushAction"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> webView = <span class="type">WKWebView</span>(frame: .zero, configuration: webConfiguration)</span><br><span class="line">webView.scrollView.bounces = <span class="literal">false</span></span><br><span class="line">webView.scrollView.showsVerticalScrollIndicator = <span class="literal">false</span></span><br><span class="line">webView.scrollView.showsHorizontalScrollIndicator = <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>通过WKScriptMessageHandler协议进行监控</li>
</ol>
<figure class="highlight swift"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">userContentController</span><span class="params">(<span class="number">_</span> userContentController: WKUserContentController, didReceive message: WKScriptMessage)</span></span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(message.name)</span><br><span class="line">    <span class="built_in">print</span>(message.body)</span><br><span class="line">    jsInvokeNativeHandler(message)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">jsInvokeNativeHandler</span><span class="params">(<span class="number">_</span> message: WKScriptMessage)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> message.isKind(of: <span class="type">WKScriptMessage</span>.<span class="keyword">self</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> serialQueue = <span class="type">DispatchQueue</span>(label: <span class="string">"com.test.mySerialQueue"</span>)</span><br><span class="line">        serialQueue.sync &#123;</span><br><span class="line">            <span class="keyword">if</span> message.name == <span class="string">"pushAction"</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">let</span> dict : <span class="type">NSDictionary</span> = message.body <span class="keyword">as</span>? <span class="type">NSDictionary</span> &#123;</span><br><span class="line">                     <span class="keyword">if</span> <span class="keyword">let</span> content = dict[<span class="string">"content"</span>] <span class="keyword">as</span>? <span class="type">String</span> &#123;</span><br><span class="line">                        <span class="keyword">self</span>.sendPushNotification(content)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>关于解析，和Web进行协议，我在H5写的代码通过message传过来的是一个字典类型 {content: ‘…’}。</p>
<h3 id="web端操作"><a href="#web端操作" class="headerlink" title="web端操作"></a>web端操作</h3><p>H5如何传递方法给native？</p>
<p>传值方法如下，iOS和Android接受的方法不同，要单独进行处理:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">window</span>.htmlCallMobileDeja = <span class="function"><span class="keyword">function</span>(<span class="params">handlerMethod, parameters</span>)</span>&#123;    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> u = navigator.userAgent; </span><br><span class="line">        <span class="keyword">var</span> isAndroid = u.indexOf(<span class="string">'Android'</span>) &gt; <span class="number">-1</span> || u.indexOf(<span class="string">'Adr'</span>) &gt; <span class="number">-1</span> </span><br><span class="line">        <span class="keyword">var</span> isiOS = !!u.match(<span class="regexp">/\(i[^;]+;( U;)? CPU.+Mac OS X/</span>) </span><br><span class="line">        <span class="keyword">if</span> (isiOS) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">window</span>.webkit) &#123;</span><br><span class="line">                <span class="built_in">window</span>.webkit.messageHandlers[handlerMethod].postMessage(dic);</span><br><span class="line">                <span class="built_in">console</span>.log(handlerMethod)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(isAndroid)&#123;</span><br><span class="line">            <span class="built_in">window</span>[<span class="string">'JsClient'</span>][handlerMethod](parameters)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span>(err) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'The native context does not exist yet'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>javascript通过这种方式进行传值</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> dic = &#123;</span><br><span class="line">    <span class="string">'event_name'</span>: event_name + <span class="string">''</span>,</span><br><span class="line">    <span class="string">'event_first_param'</span>: event_first_param + <span class="string">''</span>,</span><br><span class="line">    <span class="string">'event_second_param'</span>: event_second_param + <span class="string">''</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.htmlCallMobileDeja(<span class="string">'hideMBP'</span>, dic)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://leviduan.com/2019/03/13/2019-03-13/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Levi Duan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Levi's blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/13/2019-03-13/" itemprop="url">《剑指offer》 数组中出现次数超过一半的数字</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-13T00:00:18+08:00">
                2019-03-13
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Algorithm/" itemprop="url" rel="index">
                    <span itemprop="name">Algorithm</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/03/13/2019-03-13/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/03/13/2019-03-13/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="OJ-address"><a href="#OJ-address" class="headerlink" title="OJ address"></a>OJ address</h3><p>website : <a href="https://www.nowcoder.com/ta/coding-interviews?page=2" target="_blank" rel="noopener">《剑指offer》数组中出现次数超过一半的数字</a></p>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>数组中有一个数字出现的次数超过数组长度的一半，请找出这个数字。例如输入一个长度为9的数组{1,2,3,2,2,2,5,4,2}。由于数字2在数组中出现了5次，超过数组长度的一半，因此输出2。如果不存在则输出0。</p>
<h3 id="Solution-in-C-one-solution"><a href="#Solution-in-C-one-solution" class="headerlink" title="Solution in C++ (one solution)"></a>Solution in C++ (one solution)</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">MoreThanHalfNum_Solution</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; numbers)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = numbers.size();</span><br><span class="line">        <span class="keyword">if</span> (n==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        sort(numbers.begin(), numbers.end());</span><br><span class="line">        <span class="keyword">int</span> mid = numbers[n/<span class="number">2</span>];</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i) &#123;</span><br><span class="line">        	<span class="keyword">if</span> (numbers[i] == mid) ++count;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (count*<span class="number">2</span> &gt; n) <span class="keyword">return</span> mid;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="Solution-in-C-two-solution"><a href="#Solution-in-C-two-solution" class="headerlink" title="Solution in C++ (two solution)"></a>Solution in C++ (two solution)</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">MoreThanHalfNum_Solution</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; numbers)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = numbers.size();</span><br><span class="line">        <span class="keyword">if</span> (n==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> num = numbers[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i) &#123;</span><br><span class="line">        	<span class="keyword">if</span> (numbers[i] == num) ++count;</span><br><span class="line">        	<span class="keyword">else</span> --count;</span><br><span class="line">        	<span class="keyword">if</span> (count == <span class="number">0</span>) &#123;</span><br><span class="line">        		num = numbers[i];</span><br><span class="line">        		count = <span class="number">1</span>;</span><br><span class="line">        	&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;++i) &#123;</span><br><span class="line">        	<span class="keyword">if</span> (numbers[i] == num) ++count;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (count*<span class="number">2</span> &gt; n) <span class="keyword">return</span> num;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="My-Idea"><a href="#My-Idea" class="headerlink" title="My Idea"></a>My Idea</h3><p>Solution one ： 数组排序后，如果符合条件的数存在，则一定是数组中间那个数（比如：1，2，2，2，3；或2，2，2，3，4；或2，3，4，4，4等等）</p>
<p>Solution two ： 采用阵地攻守的思想：</p>
<ol>
<li>第一个数字作为第一个士兵，守阵地；count = 1；</li>
<li>遇到相同元素，count++;</li>
<li>遇到不相同元素，即为敌人，同归于尽,count–；当遇到count为0的情况，又以新的i值作为守阵地的士兵，继续下去，到最后还留在阵地上的士兵，有可能是主元素。</li>
<li>再加一次循环，记录这个士兵的个数看是否大于数组一般即可</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://leviduan.com/2019/03/12/2019-03-11-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Levi Duan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Levi's blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/03/12/2019-03-11-1/" itemprop="url">《剑指offer》 字符串的排列</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-03-12T00:09:22+08:00">
                2019-03-12
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Algorithm/" itemprop="url" rel="index">
                    <span itemprop="name">Algorithm</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/03/12/2019-03-11-1/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2019/03/12/2019-03-11-1/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="OJ-address"><a href="#OJ-address" class="headerlink" title="OJ address"></a>OJ address</h3><p>website : <a href="https://www.nowcoder.com/ta/coding-interviews?page=2" target="_blank" rel="noopener">《剑指offer》字符串的排列</a></p>
<h3 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h3><p>输入一个字符串,按字典序打印出该字符串中字符的所有排列。例如输入字符串abc,则打印出由字符a,b,c所能排列出来的所有字符串abc,acb,bac,bca,cab和cba。</p>
<h3 id="Solution-in-C"><a href="#Solution-in-C" class="headerlink" title="Solution in C++"></a>Solution in C++</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; result;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">string</span>&gt; Permutation(<span class="built_in">string</span> str) &#123;</span><br><span class="line">        <span class="keyword">if</span> (!str.length()) <span class="keyword">return</span> result;</span><br><span class="line">        dfs(str, <span class="number">0</span>);</span><br><span class="line">        sort(result.begin(), result.end());</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="built_in">string</span> str, <span class="keyword">int</span> begin)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (begin == str.length()) &#123;</span><br><span class="line">            result.push_back(str);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=begin;str[i]!=<span class="string">'\0'</span>;++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i!=begin &amp;&amp; str[begin]==str[i]) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            swap(str[begin], str[i]);</span><br><span class="line">            dfs(str, begin+<span class="number">1</span>);</span><br><span class="line">            swap(str[begin], str[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="My-Idea"><a href="#My-Idea" class="headerlink" title="My Idea"></a>My Idea</h3><p>全排列类型题目。解题思路就是，利用dfs深度遍历，看图说话。图已经很明显了。</p>
<ol>
<li>把第一个字符与当前字符以及后面每一个字符依次交换，获得首位后面的字符串再次进行递归； </li>
<li>递归的出口，就是只剩一个字符的时候，递归的循环过程，就是从每个子串的第二个字符开始依次与第一个字符交换，然后继续处理子串。</li>
<li>由于全排列就是从第一个数字起，每个数分别与它后面的数字交换，我们先尝试加个这样的判断——如果一个数与后面的数字相同那么这两个数就不交换了。例如abb，第一个数与后面两个数交换得bab，bba。然后abb中第二个数和第三个数相同，就不用交换了。</li>
</ol>
<p><img src="/images/15523538939861.jpg" alt></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar1.jpg" alt="Levi Duan">
            
              <p class="site-author-name" itemprop="name">Levi Duan</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">59</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/leviduan" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.reddit.com/user/leviduan" target="_blank" title="Reddit">
                      
                        <i class="fa fa-fw fa-reddit"></i>Reddit</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://medium.com/@suiyun/responses" target="_blank" title="Medium">
                      
                        <i class="fa fa-fw fa-medium"></i>Medium</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                My Favorite
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://juejin.im/user/5a52075e6fb9a01c9d31b107/posts" title="iOS Week" target="_blank">iOS Week</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.nowcoder.com/ta/coding-interviews?page=1" title="Nowcoder" target="_blank">Nowcoder</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://leetcode.com/problemset/all/" title="Leetcode" target="_blank">Leetcode</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://dribbble.com/" title="Dribbble" target="_blank">Dribbble</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://courses.edx.org/dashboard" title="Edx" target="_blank">Edx</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-apple" aria-hidden="true"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Levi Duan</span>

  
</div>

 <span class="with-love">
    <i class="fa fa-heart" aria-hidden="true"></i>
  </span>
   <span id="busuanzi_value_site_uv"></span> visitors | <span class="with-love">
    <i class="fa fa-eye" aria-hidden="true"></i>
  </span>
  <span id="busuanzi_value_site_pv"></span> times.



        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/libs/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/libs/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/libs/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/libs/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/libs/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/libs/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  

    
      <script id="dsq-count-scr" src="https://leviduan-com.disqus.com/count.js" async></script>
    

    

  




	





  









<!-- LOCAL: You can save these files to your site and update links -->
    

<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://www.wenjunjiang.win/js/gitment.js"></script>

<!-- END LOCAL -->

    
      <style>
        a.gitment-editor-footer-tip { display: none; }
        .gitment-container.gitment-footer-container { display: none; }
      </style>
    

    







  





  

  

  

  
  
  
  <link rel="stylesheet" href="/libs/needsharebutton/needsharebutton.css">

  
  
  <script src="/libs/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "box";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Twitter,Facebook,Reddit,Weibo";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
  </script>

  

  

  

  

</body>
</html>
